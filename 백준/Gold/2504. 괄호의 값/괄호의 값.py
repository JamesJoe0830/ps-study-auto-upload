# https://www.acmicpc.net/problem/2504
# 2504. ê´„í˜¸ì˜ ê°’ [ğŸ¥‡ ê³¨ë“œ5] ğŸ”¥ ì˜¤ë‹µ í•„ìš”
# ğŸ“š ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜: ìŠ¤íƒ [STACK]
# â° ê±¸ë¦° ì‹œê°„ : 50ë¶„
# 
# [ë¬¸ì œ í’€ì´]
# 0. stackì€ ì˜¬ë°”ë¥¸ ë°°ì—´ì¸ì§€ë¥¼ ê²€ì‚¬í•´ì£¼ëŠ” ì—­í• ì´ë‹¤.
# 1. ( ë‚˜ [ ì˜ ê°’ì„ ë§Œë‚˜ë©´ stackì— ë„£ì–´ì£¼ê³  ê°ê° ( ëŠ” tmp= 1(ì„ì˜ì˜ ê°’)ì— ê³±í•˜ê¸° 2 [ ëŠ” ê³±í•˜ê¸° 3ì„ í•œë‹¤.
# 2. ) ë‚˜ ] ë¥¼ ë§Œë‚¬ë‹¤ë©´ ì—¬ê¸°ì„œ ì¼€ì´ìŠ¤ë¥¼ ë¶„ë¥˜í•œë‹¤.
# 2-0. ë¨¼ì € )ë¼ë©´ tmp // 2 ë¥¼ í•˜ê³  ] ë¼ë©´ tmp // 3ì„ í•œë‹¤.
# 2-1. ) ì¼ ê²½ìš° ì§ì „ì˜ ê°’ì´ ( ì¸ì§€ë¥¼ í™•ì¸í•˜ê³  ë§ë‹¤ë©´ answerì— tmpë¥¼ ë”í•œë‹¤.
# 2-1. ] ì¼ ê²½ìš° ì§ì „ì˜ ê°’ì´ [ ì¸ì§€ë¥¼ í™•ì¸í•˜ê³  ë§ë‹¤ë©´ answerì— tmpë¥¼ ë”í•œë‹¤.
# 2-2. ë§Œì¼ ì§ì „ê°’ì´ ( ê°€ ì•„ë‹ˆë¼ë©´ answerì— ë”í•˜ì§€ ì•ŠëŠ”ë‹¤.
# 2-2. ë§Œì¼ ì§ì „ê°’ì´ [ ê°€ ì•„ë‹ˆë¼ë©´ answerì— ë”í•˜ì§€ ì•ŠëŠ”ë‹¤.
# 3. ë§ˆì§€ë§‰ì€ ëª¨ë“  ìˆœíšŒë¥¼ ë§ˆì¹˜ê³  stack ì´ ë‚¨ì•„ìˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼ì„œ ì •ë‹µì„ ì¶”ì¶œí•œë‹¤.
# ---------------------------------------------------------------- 
import sys
input = sys.stdin.readline

arr = list(input().rstrip())
stack = []

tmp = 1
answer = 0
for i in range(len(arr)):
    if arr[i] == "(" :
        stack.append(arr[i])
        tmp *= 2
    elif arr[i] == "[" :
        stack.append(arr[i])
        tmp *= 3 
    elif arr[i] == ")" :
        if len(stack) == 0 or stack[-1] !="(":
            answer = 0
            break
        if arr[i-1] == "(":
            answer += tmp
        tmp //= 2
        stack.pop()
    elif arr[i] == "]" :
        if len(stack) == 0 or stack[-1] != "[":
            answer = 0
            break
        if arr[i-1] == "[":
            answer += tmp
        tmp //= 3
        stack.pop()
        
if stack :
    print(0)
else :
    print(answer)